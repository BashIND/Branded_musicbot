from AnonX import app 
import asyncio
import random
from pyrogram import Client, filters
from pyrogram.errors import UserNotParticipant
from pyrogram.types import ChatPermissions

spam_chats = []

TAGMES = [ " **ркЪрк╛рк▓рлЛ рккрк╛рк░рлНркЯрлА ркХрк░рлАркП ЁЯе│ЁЯе│**",
                     " **ркдркорлЗ ркЧрлНрк░рлБрккркорк╛ркВ ркХрлЗрко рк╡рк╛ркд ркиркерлА ркХрк░ркдрк╛ ЁЯШТЁЯШТ**",
                     "**ркЦрлБрк╢ рк░рк╣рлЛтЬМя╕ПЁЯЩВ**",
                     "**ркорк╛ркП ркоркирлЗ ркарккркХрлЛ ркЖрккрлНркпрлЛ ЁЯе▓**",
                     " **ркдркорлЗ ркЧркИркХрк╛рк▓рлЗ ркХрлНркпрк╛ркВ ркЧркпрк╛ рк╣ркдрк╛? ЁЯдФ**",
                     "**ркЖ ркжрк┐рк╡рк╕рлЛркорк╛ркВ рк╢рлБркВ ркЪрк╛рк▓рлА рк░рк╣рлНркпрлБркВ ркЫрлЗ ЁЯШМтЭдя╕ПЁЯеА**",
                     "**рк╣рлЗрк▓рлЛ ЁЯСА**",
                     "**ркЖрккркгрлЗ ркорк┐ркдрлНрк░рлЛ ркмркирлА рк╢ркХрлАркП?**",
                     "**рк╣рлЗрк▓рлЛ ЁЯШИ**",
                      " **ркоркирлЗ ркдркорк╛рк░рк╛ ркЧрлНрк░рлБрккркорк╛ркВ ркПркб ркХрк░рлЛ рк╣рлБркВ ркжрк░рлЗркХркирлЗ ркЯрлЗркЧ ркХрк░рлАрк╢ тЭдя╕П**",
                      "**рк╢рлБркВ ркдркорлЗ ркорк╛рк░рк╛ ркорк┐ркдрлНрк░ ркЫрлЛ ЁЯШТЁЯШТ**",
                     "**ркЧркИркХрк╛рк▓рлЗ ркоркЬрк╛ ркЖрк╡рлА ЁЯе│ЁЯе│**",
                     "**ркдркорлЗ ркЦрк╛ркзрлБркВ ркЫрлЗ ЁЯШЪ**",
                     " **ркмрк╣рлБ ркЭркбрккркерлА ркЬркИ рк░рк╣рлНркпрк╛ ркЫрлАркП ЁЯШПЁЯШП**",
                     " **ркорк╛рк░рлЗ ркХрк╛рк▓рлЗ рк╢рлЛрккрк┐ркВркЧ ркХрк░рк╡рк╛ ркЬрк╡рлБркВ ркЫрлЗ ЁЯТЮ**",
                     " **рк╢рлБркВ ркдркорлЗ рк╕ркВркмркВркзркорк╛ркВ ркЫрлЛ? ЁЯСА** ",
                     " **ркЕркирлЗ ркХрлЗркжрлА ркХрлЗрк╡рлЛ ркЫрлЗ ЁЯСА**",
                   "**рк╢рлБркВ ркдркорлЗ ркХрлНркпрк╛рк░рлЗркп ркоркирлЗ ркпрк╛ркж ркХрк░рлЛ ркЫрлЛ ЁЯе║ЁЯе║**",
                     "**ркоркирлЗ ркнрлВрк▓рлА ркЧркпрлЛ ЁЯе║ЁЯеА**",
                     " **ркЖркЬрлЗ ркорлЗркВ ркПркХ рк╡рк╛ркВркжрк░рлЛ ркЬрлЛркпрлЛ ЁЯШМЁЯСЙЁЯРТ**",
                     " ** ркЯрлЛркХ ркорлЗрки тЭдя╕ПЁЯСА** ",
                     "**рк╡рлЛркЗрк╕ ркЪрлЗркЯ рккрк░ ркЖрк╡рлЛ**",
                     " **рк╡рлЛркИрк╕ ркЪрлЗркЯ рккрк░ рк▓ркбрк╛ркИ ЁЯдпЁЯдп**",
                     " **ркоркирлЗ ркХрлНркпрк╛рк░рлЗркп ркорк┐рк╕ ркирк╛ ркХрк░рк╢рлЛ ЁЯТФЁЯТФ**",
                     " **рк╣рк╛ ЁЯСА**",
                     "**ркжрлЛрк╕рлНркд ркдрлБркВ ркХрлНркпрк╛ркВ ркЫрлЗ тЭдя╕ПЁЯТл**",
                     " **ркоркирлЗ ркдркорк╛рк░рк╛ ркЧрлНрк░рлБрккркорк╛ркВ ркПркб ркХрк░рлЛ ЁЯе║**",
                     " **ркЕрк╣рлАркВ ркЖрк╡рлЛ @INCRICIBLE ЁЯСА**",
                     "** рк╢рлБркВ ркдркорлЗ рк╕рлВркИ ркЧркпрк╛ ЁЯдФЁЯдФ **",
                     "** рк╣рлЗрк▓рлЛ ркЬрлА ЁЯТЮ **",
                     "**ркдркорк╛рк░рк╛ ркЬрлЗрк╡рлЛ ркорк┐ркдрлНрк░ рк╣рлЛркп ркдрлЛ ркЪрк┐ркВркдрк╛ ркХрк░рк╡рк╛ркирлА рк╢рлБркВ рк╡рк╛ркд ркЫрлЗ?тЭгя╕П**",
                     " **ркХрлЗркЯрк▓рлЛ ркорлМрки ркЫрлЛ ркжрлЛрк╕рлНркд ЁЯШТ**",
                     " **ркдркорлЗ ркЧрлАркд ркЬрк╛ркгрлЛ ркЫрлЛ ЁЯСА**",
                     "** ркмркзрк╛ркирлЗ рк╢рк╛ркВркд ркХрк░рлЛ**",
                     "**рк╣рк╛ркп ЁЯСА**",
                     " **ркдркорк╛рк░рк╛ ркШрк░ркорк╛ркВ ркмркзрк╛ ркХрлЗрко ркЫрлЗ ЁЯШМтЭдя╕ПЁЯеА**",
                     "**ркЙркарлЛ рккркг ЁЯШ╢**",
                     "**ркдркорлЗ ркХрлЗркЯрк▓рк╛ рк╕ркоркпркерлА ркЫрлЛ ЁЯзР**",
                     " **ркорлЗркВ ркорк╛рк░рлА #рк╡рк┐рк╢рлНрк╡рк╢рк┐рк╢рлЛ ЁЯШЗ ркжрлАрк╡рк╛рк▓ ркмркирк╛рк╡рлА ркЫрлЗ , ркЦрк╛ркоркЦрк╛рки #ZindvEgi ркорк╛ркВ ркЕркирк╛рк░ркХрк▓рлА ЁЯТГ ркдрк░рлАркХрлЗ ркирк╛ркЪркдрлЛ рк╣ркдрлЛ ** ",
                     " **ркКркВркШ ркЙркбрлА ркЧркИ ркЫрлЗ #ЁЭЧаЁЭЧШЁЭЧеЁЭЧЬ ркХрлЛркИркП ркХрк╣рлАркирлЗ**",
                    " **SUNOOЁЯСВЁЯСВЁЯСВтАж ркдркорлЗ ЁЯСз ркирлЗ ркдркорк╛рк░рлБркВ ркмркирк╛рк╡рлАркирлЗ ркЬ рк░рк╛ркЦрлЛ ркЫрлЛ, ркмрлАркЬрк╛ркП #__ЁЯз╕ЁЯТаЁЯЧ╕ЁЯТФЁЯМ╖ЁЯТФ..!!ЁЯШФ**",
                     "* ркЙркВркШ ркЙркбрлА ркЧркИ ркЫрлЗ ркХрлЛркИркП... ркХрк╣рлАркирлЗ**",
                     " **#_DgizoolЁЯТЦ ркдрлЗркерлА ркжрк░рлЗркХ рккрк╛рк╕рлЗ ркдрлЗ ркЫрлЗ, рккрк░ркВркдрлБ ркмркзрк╛ рккрк╛рк╕рлЗ ркиркерлА #ЁЯТСрдЗрдЬрд╝рд╡рд╛рд▓реИрдореЗтЭМтАж**",
                     " **#рд╕реВрдЖрдВрдмрд╕ЁЯСВ #рдЗрдЬрд┐рддрд╛ рд╣реИ рддреБрдорд╕реЗрдм**",
                     " **ркорлЗркВ #рдЖрдкрд╡рд┐рдЬрд╝реЛрдВ рдЦреНрд╡рд╛рдИ ЁЯШЗ ркжрлАрк╡рк╛рк▓ ркмркирк╛рк╡рлА ЁЯШЗ, ркЦрк╛ркоркЦрк╛рки #ркЬрлАрк╡ркиркорк╛ркВ ркЕркирк╛рк░ркХрк▓рлАЁЯТГ ркмркирлАркирлЗ ркирк╛ркЪркдрлЛ рк╣ркдрлЛ**",
                     " **ркЖрк╣ ркЬрк░рлВрк░ ркЫрлЗ #рк╡рлЗркбтШЭ ркЬрлНркпрк╛ркВ рк╕рлБркзрлА ркЙркВркорк░ ркЕрк╕рк░ ркерк╛ркп, ркЬрлЗ ркЬрлАрк╡рлЗ ркдрлНркпрк╛ркВ рк╕рлБркзрлА ЁЭЧзЁЭЧеЁЭЧоЁЭЧ╢ЁЭЧ╗ЁЭЧ╢**",
                     " ** ркЖркЧрк░ рк╡рк╛ркЧрк░ рк╡рк╛ркЧрк░ рк╡рк┐рк╢рлЗрк╖ рк╡рк┐рк╢рлЗрк╖ ркЕркирлЗ рк╣рлБркВ ркПркХрк▓рк╛ рк░рк╣рлЗрк╡рлБркВ рк╕рк╛рк░рлБркВ ** ,
                     " ** ркЭркШркбрлЛ ркдрлНркпрк╛рк░рлЗ ркЬ ркерк╛ркп ркЬрлНркпрк╛рк░рлЗ # ркбркЧрк░рлНркб рк╣рлЛркп, ркЕркирлЗ # рккрлЗрк░рлНркб ркдрлНркпрк╛ркВ рк╣рлЛркп ркЬрлНркпрк╛ркВ # рккркЬрлЗркЬркпрк░ЁЯТЭ рк╣рлЛркп**",
                     " **#_InstagramЁЭЧл ркЬрлЛ ркдркорлЗ #_Facebook ркирлА рк╡рк╛ркд ркХрк░рлЛ ркЫрлЛ, ркдрлЛ #_ЁЯУМЁЭЧл ркдрлЗркирк╛ рккрк░ #рк▓рк╛ркбркХрлА рккркг рк╕рлЗркЯ ркХрк░рлЗ ркЫрлЗ**",
                     " **#рдЕрдордЧреЗрдЯрд▓рдЧреАрд╖ рдХреА рдмреВрдЦ рдмреЛрдЦ**",
                     " **#ЁЭЧгЁЭЧ┐ЁЭЧоЁЭЧ┐ЁЭЧ╢ЁЭЧ╢ЁЭЧ╗ЁЭЧ╢ЁЭЧ╢ЁЭЧ╢ЁЭЧ╢ЁЭЧ╢ЁЭЧ╢**",
                     " **ркдркорк╛рк░рк╛ #ркнрк╛рк░ркдркорк╛ркВ ркнрк▓рлЗ ркдрлЗ #рк╕рк░ркХрк╛рк░ рк╣рлЛркп ркХрлЗ #рк╢рк╛ркжрлАЁЯСл, ркжрк░рлЗркХркирлЗ тШЭ рк╡рк░рлНрк╖ркорк╛ркВ #ркЦрлБрк╕ ркЦркмрк░рлА ркЬрлЛркИркП ркЫрлЗ..**",
                     "** ркоркирлЗ рк▓рк╛ркЧрлЗ ркЫрлЗ ЁЯдФ ркмрк╣рлБ ркЬрк▓рлНркжрлА рккрк░рк┐рк╡рк╛рк░ркирк╛ рк╕ркнрлНркпрлЛ ркорк╛рк░рлЛ ЁЯЩД# ЁЯМЬркорлЛркмрк╛ркИрк▓ ЁЯУ▓ ркЕркирлЗ ркЪрк╛рк░рлНркЬрк░ ЁЯФМ рккркХркбрлАркирлЗ ркоркирлЗ ркШрк░ркирлА ркмрк╣рк╛рк░ рклрлЗркВркХрлА ркжрлЗрк╢рлЗ**",
                     " ** рк╣рк░рк┐ркВ ркПрк╡рк╛ #рк▓рлМркбрлАЁЯС╕ркирлЗ рккрлНрк░ркнрк╛рк╡рк┐ркд ркХрк░рк╢рлЗ ркЬрлЗркУ ркмрк╣рк╛рк░ ркЫрлЗ....ркЬрлЗркирлЗ ркЬрлЛркИркирлЗ #ркбрлБрк│ЁЯТЭ ркирлЗ ЁЭЯ░ЁЭЯ░0 рк╡рлЛрк▓рлНркЯркирк╛ ркЖркВркЪркХрк╛ ркЖрк╡рлЗ ркЫрлЗ.ЁЯШВ** ",
                     " ** ркЬрлЛ ркдркорк╛рк░рлЗ рк╕ркоркп ркмркЧрк╛ркбрк╡рлЛ рк╣рлЛркп ркдрлЛ ЁЯШПЁЯШВЁЯШВЁЯША**",
                     " ** ркдркорлЗ ркЖркЦрк╛ рк╢рк╣рлЗрк░ркорк╛ркВ ркХрлЗрко ркиркерлА рклрк░ркдрк╛, рк╕рлМркерлА рк╡ркзрлБ #_рк╣рлЛркЯ_#рк▓рлЙркбрлА ркдрлЛ ркЬ ркЬрлЛрк╡рк╛ ркорк│рк╢рлЗ ЁЯТФЁЯТЭ рккрк░рк┐рк╡рк╛рк░ркирк╛ рк╕ркнрлНркпрлЛ ркдркорк╛рк░рлА рк╕рк╛ркерлЗ ркЫрлЗ**",
                     " **ркорлЗркВ рк╕рк╛ркВркнрк│рлНркпрлБркВ ркЫрлЗ ркХрлЗ ркЫрлЛркХрк░рлАркУ #рк╢рк╛ркпрк░рлА рк▓ркЦрлАркирлЗ рк╡ркзрлБ рккрлНрк░ркнрк╛рк╡рк┐ркд ркерк╛ркп ркЫрлЗтАж.. ркЪрк╛рк▓рлЛ ркЖ рк╡рк░рлНрк╖рлЗ рккркг ркЯрлНрк░рк╛ркп ркХрк░рлАркПЁЯШВЁЯШВ**",
   
         ]



@app.on_message(filters.command(["gjtag"," gtag"], prefixes=["/", "@", "#"]))
async def mentionall(client, message):
    chat_id = message.chat.id
    if message.chat.type == "private":
        return await message.reply("This command can be used in groups and channels!")

    is_admin = False
    try:
        participant = await client.get_chat_member(chat_id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in ("administrator", "creator"):
            is_admin = True
    if not is_admin:
        return await message.reply("Only admin can use this command!")

    if message.reply_to_message and message.text:
        return await message.reply("/htag Try this next time for tagging..")
    elif message.text:
        mode = "text_on_cmd"
        msg = message.text
    elif message.reply_to_message:
        mode = "text_on_reply"
        msg = message.reply_to_message
        if not msg:
            return await message.reply("/htag hii ЁЯСИ Try this or reply any message...")
    else:
        return await message.reply("/htag hii ЁЯСИ Try this or reply any message...")

    spam_chats.append(chat_id)
    usrnum = 0
    usrtxt = ""
    async for usr in client.iter_chat_members(chat_id):
        if not chat_id in spam_chats:
            break
        if usr.user.is_bot:
            continue
        usrnum += 1
        usrtxt += f"[{usr.user.first_name}](tg://user?id={usr.user.id}) "

        if usrnum == 1:
            if mode == "text_on_cmd":
                txt = f"{usrtxt} {random.choice(TAGMES)}"
                await client.send_message(chat_id, txt)
            elif mode == "text_on_reply":
                await msg.reply(f"[{random.choice(EMOJI)}](tg://user?id={usr.user.id})")
            await asyncio.sleep(4)
            usrnum = 0
            usrtxt = ""
    try:
        spam_chats.remove(chat_id)
    except:
        pass

@app.on_message(filters.command(["cancel", "stop"]))
async def cancel_spam(client, message):
    if not message.chat.id in spam_chats:
        return await message.reply("No active mention process is started by me.")
    is_admin = False
    try:
        participant = await client.get_chat_member(message.chat.id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in ("administrator", "creator"):
            is_admin = True
    if not is_admin:
        return await message.reply("This command is only for admins. You can't use this command.")
    else:
        try:
            spam_chats.remove(message.chat.id)
        except:
            pass
        return await message.reply("тЩж Mention process stopped тЩж")
